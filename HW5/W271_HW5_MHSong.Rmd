---
title: "**W271**-2 -- Spring 2016 -- **HW 5**"
author: "***Juanjo Carin, Kevin Davis, Ashley Levato, Minghu Song***"
date: "*March 9, 2016*"
output:
   pdf_document:
     fig_caption: yes
     toc: yes
numbersections: false
geometry: margin=1in
options: width=30
fontsize: 10pt
linkcolor: blue
header-includes:
- \usepackage{fancyhdr}
- \pagestyle{fancy}
- \fancyhead[LO,LE]{Carin, Davis, Levato, Song}
- \fancyhead[CE,CO]{W271 -- HW 5 -- \leftmark}
- \fancyhead[RE,RO]{\rightmark}
- \fancyfoot[LO,LE]{UC Berkeley -- MIDS}
- \fancyfoot[CO,CE]{Spring semester 2016}
- \fancyfoot[RE,RO]{\thepage}
- \renewcommand{\headrulewidth}{0.5pt}
- \renewcommand{\footrulewidth}{0.5pt}
---

**********

\pagebreak

# Exercises

```{r, echo = FALSE}
require(knitr, quietly = TRUE)
read_chunk('code/W271_HW5_MHSong.R')
opts_chunk$set(message = FALSE, warning = FALSE)
opts_chunk$set(fig.width = 4, fig.height = 3)
# Set path to data here (don't use setwd() inside a chunk!!!)
opts_knit$set(root.dir = 'C:/Users/songminghu/Documents/GitHub/W271/HW5')
```

```{r Libraries-Functions-Constants, echo = FALSE}
```



## Question 1

1. **Install the library `"astsa"` using the function: `install.packages("astsa")`**

```{r Question1-1, echo = -c(1:2)}
```

2. **Load the library: `library(astsa)`**

```{r Question1-2, echo = TRUE}
```

3. **Use the function `str()` to see the information of a particular data series, such as `str(EQ5)` for the Seismic Trace of Earthquake number 5 series**

```{r Question1-3, echo = -c(1:2)}
```

According to that [package documentation](https://cran.r-project.org/web/packages/astsa/astsa.pdf), `EQ5` corresponds to the *Seismic trace of an earthquake [two phases or arrivals along the surface, the primary wave (t = 1, . . . , 1024) and the shear wave (t = 1025, . . . , 2048)] recorded at a seismic station.*

4. **Plot the time series plots and histograms of the following 3 series. Feel free to use the codes provided in the R scripts. Make sure that each of your graph has a title, the axis ticks are clear, the axes are well-labelled, and use color intelligently.**

```{r Question1-4, echo = TRUE, fig.width = 3.5, fig.height = 2.5}
```


5. **Write a few sentences to describe each of the series.**

  + **EQ5:**
  The EQ5 data encodes the seismic trace of an earthquake saved as the ts data class. It include two arrive phases: primary wave or P phase (t=1, ... ,1024) and the shear wave or S phase (t= 1025, ..., 2048)]. In this series, the amplitude of the P phase is much smaller than the amplitude of the S phase.  In addition, as shown in the above time series plot, it seems that the S phase of EQ5 series is periodic as well because it contains several similar segments with the equal length.  

  + **flu:**
  The flu data records monthly deaths per 10,000 people due to pneumonia and influenza in the United States for a period of 132 months(1968-1978). This series also exhibits a periodic pattern that the death rate tends to be the highest in January and then decreases gradually till next year.  

  + **gas:**
  The gas data collects the weekly price of gasoline in cents per gallon at New York Harbor from 2000 to mid-2010.  According to the data, gas price fist gradually go up, but drop suddently around the 4th quarter of 2009.   


**********

## Question 2

**Describe 3 examples you have used in your work or encounter in real life. Ideally, you can even load at least one of these time series, plot it, and the write a few statements to describe its characteristics.**

+ **the Example of Biotech Stocks:**
Stock closing data is one kind of Non-regular time series and they will change every day as a result of market forces.  We use Biogen as the example here. Its closing stock price went up and down significantly in 2015 due to the promising clinical results of aducanumab for Alzheimer treatment in March as well as later unexpected slowing sales of its multiple sclerosis drug, Tecfidera.  
   
```{r Question2-1, echo = -c(1:1)}
```

+ **the Example of Daily Averaged Tempreture  at JFK airport:**
The 2nd data is the daily averaged tempretaure recorded at JFK airport weather station.  The data is directly pulled out through the WeatherData package. Similar to stock price, it is also non-regular time series data.         

```{r Question2-2, echo = -c(1:1)}
```

+ **the Example Monthly Averaged Electricity Usage Example:**
The 3rd examples show the monthly averaged electricity usage of my house between 2014 and 2015.  This data shown summers, in general, tended to have lower monthly averaged electricity usage (<20KWh) than the other seasons.  

```{r Question2-3, echo = -c(1:1)}
```

+ **the fMRI Example:**
Functional Magnetic Resonance Imaging (fMRI) is a powerful technique to address the functional connectivity within brain. We used the fMRI data in the astsa package as the illustrating example here. The plot below shows the fMRI spectrum measuring the blood oxygenationlevel
dependent (BOLD) signal intensity from the cortex of four differnt subjects. For each subject, singals were sampled every 2 seconds for 256 seconds totally(n=128).  During the sampling process, the stimulus was first applied for 32 seconds and then stopped for the subsequent 32 seconds. Therefore, the whole sampling process (256 seconds) covers four periodic components.  


```{r Question2-3, echo = -c(1:1)}
```

**********

## Question 3

**Simulate a white noise series with 1000 random draws and plot (1) a time series plot and (2) a histogram. The usual reqirements on graphics (described) in Question 1) applied.**

```{r Question3,echo = -c(1:4), fig.width = 3.5, fig.height = 2.5}
```



**********

## Question 4

**Simulate (with 1000 random draws) the following two zero-mean autoregressive model with order 1 (i.e. AR(1)) models:**

$$\mathbf{y_t = 0.9y_{t1} + w}$$

$$\mathbf{y_t = 0.2y_{t1} + w}$$

**Plot a time plot for each of the simulated series. Graph a histogram for each of the simulated series. Write a few statements to compare the two series.**

```{r Question4, echo = -c(1:7)}
```



**********

## Question 5

**Simulate (with 1000 random draws) the following 3 models:**

1. **A deterministic linear (time) trend of the form: $y_t = 10 + 0.5t$**

2. **Random walk without drift**

3. **Random walk with drift = 0.5**

**Plot a time plot for each of the simulated series. Graph a histogram for each of the simulated series. Write a few statements to compare the two series.**

```{r Question5, echo = -c(1:7)}
```

**********
